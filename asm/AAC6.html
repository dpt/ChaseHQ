<!DOCTYPE html>
<html>
<head>
<title>Chase H.Q.: Routine at AAC6</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Chase H.Q.</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="AA38.html">AA38</a>
</td>
<td class="up">Up: <a href="../maps/all.html#43718">Map</a></td>
<td class="next">
Next: <a href="AB33.html">AB33</a>
</td>
</tr>
</table>
<div class="description">AAC6: Routine at AAC6</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="8401.html">main_loop</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">move_helicopter</td>
<td class="address-2"><span id="43718"></span>AAC6</td>
<td class="instruction">LD A,($A224)</td>
<td class="comment-1" rowspan="3">Return if helicopter_control is zero</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43721"></span>AAC9</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43722"></span>AACA</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43723"></span>AACB</td>
<td class="instruction">LD A,$00</td>
<td class="comment-1" rowspan="1">A = &lt;self modified&gt;  -- Self modified by <a href="AAC6.html#43731">AAD3</a> below</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43725"></span>AACD</td>
<td class="instruction">CP $61</td>
<td class="comment-1" rowspan="2">Jump to <a href="AAC6.html#43734">move_helicopter_0</a> if A == 97</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43727"></span>AACF</td>
<td class="instruction">JR Z,<a href="AAC6.html#43734">move_helicopter_0</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43729"></span>AAD1</td>
<td class="instruction">SUB $02</td>
<td class="comment-1" rowspan="1">A -= 2</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43731"></span>AAD3</td>
<td class="instruction">LD ($AACC),A</td>
<td class="comment-1" rowspan="1">Self modify <a href="AAC6.html#43723">AACB</a> above</td>
</tr>
<tr>
<td class="asm-label">move_helicopter_0</td>
<td class="address-2"><span id="43734"></span>AAD6</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1">C = A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43735"></span>AAD7</td>
<td class="instruction">LD A,$00</td>
<td class="comment-1" rowspan="1">A = &lt;self modified&gt;  -- Self modified below</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43737"></span>AAD9</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="2">A = (A + 1) &amp; 3</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43738"></span>AADA</td>
<td class="instruction">AND $03</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43740"></span>AADC</td>
<td class="instruction">LD ($AAD8),A</td>
<td class="comment-1" rowspan="1">Self modify <a href="AAC6.html#43735">AAD7</a> above</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43743"></span>AADF</td>
<td class="instruction">LD A,$01</td>
<td class="comment-1" rowspan="1">A = &lt;self modified&gt; -- Self modified by <a href="AAC6.html#43749">AAE5</a> below</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43745"></span>AAE1</td>
<td class="instruction">JR NZ,<a href="AAC6.html#43752">move_helicopter_1</a></td>
<td class="comment-1" rowspan="1">what are we testing here?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43747"></span>AAE3</td>
<td class="instruction">NEG</td>
<td class="comment-1" rowspan="1">A = -A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43749"></span>AAE5</td>
<td class="instruction">LD ($AAE0),A</td>
<td class="comment-1" rowspan="1">Self modify <a href="AAC6.html#43743">AADF</a> above</td>
</tr>
<tr>
<td class="asm-label">move_helicopter_1</td>
<td class="address-2"><span id="43752"></span>AAE8</td>
<td class="instruction">ADD A,$00</td>
<td class="comment-1" rowspan="1">A += &lt;self modified&gt;  -- Increment by old amount -- Self modified below</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43754"></span>AAEA</td>
<td class="instruction">LD ($AAE9),A</td>
<td class="comment-1" rowspan="1">Self modify above with new value of A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43757"></span>AAED</td>
<td class="instruction">ADD A,C</td>
<td class="comment-1" rowspan="1">A += C</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43758"></span>AAEE</td>
<td class="instruction">LD ($AA5B),A</td>
<td class="comment-1" rowspan="1">Self modify 'LD A' @ <a href="AA38.html#43610">AA5A</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43761"></span>AAF1</td>
<td class="instruction">LD HL,($A26C)</td>
<td class="comment-1" rowspan="1">HL = road_pos</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43764"></span>AAF4</td>
<td class="instruction">LD D,H</td>
<td class="comment-1" rowspan="2">DE = HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43765"></span>AAF5</td>
<td class="instruction">LD E,L</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43766"></span>AAF6</td>
<td class="instruction">LD BC,$0000</td>
<td class="comment-1" rowspan="1">BC = &lt;self modified&gt;  -- Self modified by <a href="AAC6.html#43772">AAFC</a> below, <a href="AB33.html#43872">AB60</a>  -- prev road pos?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43769"></span>AAF9</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1">Set flags</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43770"></span>AAFA</td>
<td class="instruction">SBC HL,BC</td>
<td class="comment-1" rowspan="1">HL -= BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43772"></span>AAFC</td>
<td class="instruction">LD ($AAF7),DE</td>
<td class="comment-1" rowspan="1">Self modify 'LD BC' above to load DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43776"></span>AB00</td>
<td class="instruction">LD DE,($AA95)</td>
<td class="comment-1" rowspan="1">Load DE from 'LD BC' @ <a href="AA38.html#43668">sub_AA94</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43780"></span>AB04</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1">HL += DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43781"></span>AB05</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Preserve HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43782"></span>AB06</td>
<td class="instruction">LD DE,$0070</td>
<td class="comment-1" rowspan="1">DE = $0070</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43785"></span>AB09</td>
<td class="instruction">LD B,$00</td>
<td class="comment-1" rowspan="1">B = 0</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43787"></span>AB0B</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1">Set flags</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43788"></span>AB0C</td>
<td class="instruction">SBC HL,DE</td>
<td class="comment-1" rowspan="1">HL -= DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43790"></span>AB0E</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43791"></span>AB0F</td>
<td class="instruction">JR Z,<a href="AAC6.html#43823">move_helicopter_5</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43793"></span>AB11</td>
<td class="instruction">LD A,$08</td>
<td class="comment-1" rowspan="1">A = 8</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43795"></span>AB13</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Preserve AF</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43796"></span>AB14</td>
<td class="instruction">JP M,<a href="AAC6.html#43802">move_helicopter_2</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43799"></span>AB17</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1">B--</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43800"></span>AB18</td>
<td class="instruction">NEG</td>
<td class="comment-1" rowspan="1">A = -A</td>
</tr>
<tr>
<td class="asm-label">move_helicopter_2</td>
<td class="address-2"><span id="43802"></span>AB1A</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1">C = A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43803"></span>AB1B</td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-1" rowspan="1">HL += BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43804"></span>AB1C</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Preserve HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43805"></span>AB1D</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1">Set flags</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43806"></span>AB1E</td>
<td class="instruction">SBC HL,DE</td>
<td class="comment-1" rowspan="1">HL -= DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43808"></span>AB20</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43809"></span>AB21</td>
<td class="instruction">JP M,<a href="AAC6.html#43818">move_helicopter_3</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43812"></span>AB24</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore AF</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43813"></span>AB25</td>
<td class="instruction">JP P,<a href="AAC6.html#43823">move_helicopter_5</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43816"></span>AB28</td>
<td class="instruction">JR <a href="AAC6.html#43822">move_helicopter_4</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">move_helicopter_3</td>
<td class="address-2"><span id="43818"></span>AB2A</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore AF</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43819"></span>AB2B</td>
<td class="instruction">JP M,<a href="AAC6.html#43823">move_helicopter_5</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">move_helicopter_4</td>
<td class="address-2"><span id="43822"></span>AB2E</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">move_helicopter_5</td>
<td class="address-2"><span id="43823"></span>AB2F</td>
<td class="instruction">LD ($AA95),HL</td>
<td class="comment-1" rowspan="1">Self modify 'LD BC' @ <a href="AA38.html#43668">sub_AA94</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43826"></span>AB32</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="AA38.html">AA38</a>
</td>
<td class="up">Up: <a href="../maps/all.html#43718">Map</a></td>
<td class="next">
Next: <a href="AB33.html">AB33</a>
</td>
</tr>
</table>
<footer>
<div class="release">The incomplete Chase H.Q. disassembly 20231102</div>
<div class="copyright">&copy; 1988 Taito Corporation &copy; 1989 Ocean Software Ltd. (Chase H.Q.) © 2023 David Thomas (this disassembly)</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.9.</div>
</footer>
</body>
</html>