<!DOCTYPE html>
<html>
<head>
<title>Chase H.Q.: Routine at A9DE</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Chase H.Q.</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="A97E.html">A97E</a>
</td>
<td class="up">Up: <a href="../maps/all.html#43486">Map</a></td>
<td class="next">
Next: <a href="AA38.html">AA38</a>
</td>
</tr>
</table>
<div class="description">A9DE: Dust/Stones stuff</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="8F5F.html">main_loop_23</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">sub_A9DE</td>
<td class="address-2"><span id="43486"></span>A9DE</td>
<td class="instruction">LD A,$00</td>
<td class="comment-1" rowspan="1">A = &lt;self modified&gt;  Self modified by <a href="A955.html#43386">A97A</a>, <a href="A97E.html#43427">A9A3</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43488"></span>A9E0</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1">Set flags</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43489"></span>A9E1</td>
<td class="instruction">RET Z</td>
<td class="comment-1" rowspan="1">Return if zero</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43490"></span>A9E2</td>
<td class="instruction">LD HL,$ED28</td>
<td class="comment-1" rowspan="1">Point <span class="register">HL</span> at (something above the stack)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43493"></span>A9E5</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="3">A = *HL; HL += 2</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43494"></span>A9E6</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43495"></span>A9E7</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43496"></span>A9E8</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1">Set flags</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43497"></span>A9E9</td>
<td class="instruction">JR NZ,<a href="A9DE.html#43505">sub_A9DE_0</a></td>
<td class="comment-1" rowspan="1">Jump to A9F1 if non-zero</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43499"></span>A9EB</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="2">HL += 2</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43500"></span>A9EC</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43501"></span>A9ED</td>
<td class="instruction">LD ($A9E3),HL</td>
<td class="comment-1" rowspan="1">Self modify 'LD HL,x' @ <a href="A9DE.html#43490">A9E2</a> to load HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43504"></span>A9F0</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return</td>
</tr>
<tr>
<td class="asm-label">sub_A9DE_0</td>
<td class="address-2"><span id="43505"></span>A9F1</td>
<td class="instruction">LD DE,($5D0C)</td>
<td class="comment-1" rowspan="1">DE = *stones_lods</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43509"></span>A9F5</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">A--</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43510"></span>A9F6</td>
<td class="instruction">JR Z,<a href="A9DE.html#43516">sub_A9DE_1</a></td>
<td class="comment-1" rowspan="2">If non-zero DE = *dust_lods</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43512"></span>A9F8</td>
<td class="instruction">LD DE,($5D0E)</td>
</tr>
<tr>
<td class="asm-label">sub_A9DE_1</td>
<td class="address-2"><span id="43516"></span>A9FC</td>
<td class="instruction">LD C,(HL)</td>
<td class="comment-1" rowspan="2">C = *HL++</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43517"></span>A9FD</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43518"></span>A9FE</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1">A = *HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43519"></span>A9FF</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43520"></span>AA00</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">HL++</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43521"></span>AA01</td>
<td class="instruction">LD ($A9E3),HL</td>
<td class="comment-1" rowspan="1">Self modify 'LD HL,x' @ <a href="A9DE.html#43490">A9E2</a> to load HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43524"></span>AA04</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1">A = 0</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43525"></span>AA05</td>
<td class="instruction">LD ($933E),A</td>
<td class="comment-1" rowspan="1">Self modify 'LD D,x' @ <a href="92E1.html#37693">draw_object_right_8</a> to load zero</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43528"></span>AA08</td>
<td class="instruction">LD H,A</td>
<td class="comment-1" rowspan="1">H = A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43529"></span>AA09</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="1">A = B</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43530"></span>AA0A</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">A--</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43531"></span>AA0B</td>
<td class="instruction">CP $0B</td>
<td class="comment-1" rowspan="3">If A &gt; 10 A = 10</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43533"></span>AA0D</td>
<td class="instruction">JR C,<a href="A9DE.html#43537">sub_A9DE_2</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43535"></span>AA0F</td>
<td class="instruction">LD A,$0A</td>
</tr>
<tr>
<td class="asm-label">sub_A9DE_2</td>
<td class="address-2"><span id="43537"></span>AA11</td>
<td class="instruction">SRL A</td>
<td class="comment-1" rowspan="1">A &gt;&gt;= 1</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43539"></span>AA13</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="6">L = A * 7</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43540"></span>AA14</td>
<td class="instruction">RLCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43541"></span>AA15</td>
<td class="instruction">RLCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43542"></span>AA16</td>
<td class="instruction">RLCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43543"></span>AA17</td>
<td class="instruction">SUB L</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43544"></span>AA18</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43545"></span>AA19</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1">HL += DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43546"></span>AA1A</td>
<td class="instruction">LD E,(HL)</td>
<td class="comment-1" rowspan="4">E = *HL * 8</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43547"></span>AA1B</td>
<td class="instruction">RLC E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43549"></span>AA1D</td>
<td class="instruction">RLC E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43551"></span>AA1F</td>
<td class="instruction">RLC E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43553"></span>AA21</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43554"></span>AA22</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1">Set flags</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43555"></span>AA23</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1">A = C</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43556"></span>AA24</td>
<td class="instruction">LD C,$00</td>
<td class="comment-1" rowspan="1">C = $00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43558"></span>AA26</td>
<td class="instruction">JP M,<a href="A9DE.html#43571">sub_A9DE_3</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="A9DE.html#43571">sub_A9DE_3</a> if negative</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43561"></span>AA29</td>
<td class="instruction">RET NZ</td>
<td class="comment-1" rowspan="1">Return if non-zero</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43562"></span>AA2A</td>
<td class="instruction">CP $80</td>
<td class="comment-1" rowspan="2">Jump to <a href="92E1.html#37635">9303</a> if A &gt;= 128</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43564"></span>AA2C</td>
<td class="instruction">JP NC,<a href="92E1.html#37641">draw_object_right_3</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43567"></span>AA2F</td>
<td class="instruction">ADD A,E</td>
<td class="comment-1" rowspan="1">A += E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43568"></span>AA30</td>
<td class="instruction">JP <a href="9278.html#37530">draw_object_left_1</a></td>
<td class="comment-1" rowspan="1">Exit via <a href="9278.html#37530">draw_object_left_1</a></td>
</tr>
<tr>
<td class="asm-label">sub_A9DE_3</td>
<td class="address-2"><span id="43571"></span>AA33</td>
<td class="instruction">ADD A,E</td>
<td class="comment-1" rowspan="1">A += E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43572"></span>AA34</td>
<td class="instruction">RET NC</td>
<td class="comment-1" rowspan="1">Return if no carry</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43573"></span>AA35</td>
<td class="instruction">JP <a href="9278.html#37530">draw_object_left_1</a></td>
<td class="comment-1" rowspan="1">Exit via <a href="9278.html#37530">draw_object_left_1</a></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="A97E.html">A97E</a>
</td>
<td class="up">Up: <a href="../maps/all.html#43486">Map</a></td>
<td class="next">
Next: <a href="AA38.html">AA38</a>
</td>
</tr>
</table>
<footer>
<div class="release">The incomplete Chase H.Q. disassembly 20231102</div>
<div class="copyright">&copy; 1988 Taito Corporation &copy; 1989 Ocean Software Ltd. (Chase H.Q.) © 2023 David Thomas (this disassembly)</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.9.</div>
</footer>
</body>
</html>