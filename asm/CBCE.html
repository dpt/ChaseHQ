<!DOCTYPE html>
<html>
<head>
<title>Chase H.Q.: Routine at CBCE</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Chase H.Q.</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="CBC5.html">CBC5</a>
</td>
<td class="up">Up: <a href="../maps/all.html#52174">Map</a></td>
<td class="next">
Next: <a href="CD3A.html">CD3A</a>
</td>
</tr>
</table>
<div class="description">CBCE: Routine at CBCE - road drawing stuff</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="B9F4.html">main_loop_12</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="52174"></span>CBCE</td>
<td class="instruction">LD HL,$EEEC</td>
<td class="comment-1" rowspan="1">Load two high bytes ($EExx table offset, $ECxx table offset)</td>
</tr>
<tr>
<td class="address-1"><span id="52177"></span>CBD1</td>
<td class="instruction">LD DE,$44ED</td>
<td class="comment-1" rowspan="1">$ED $44 =&gt; NEG instr for <a href="CBCE.html#52257">CC21</a> &amp; <a href="CBCE.html#52258">CC22</a></td>
</tr>
<tr>
<td class="address-1"><span id="52180"></span>CBD4</td>
<td class="instruction">JR $CBDC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52182"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="B9F4.html">main_loop_12</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="52182"></span>CBD6</td>
<td class="instruction">LD HL,$EDE9</td>
<td class="comment-1" rowspan="1">Load two high bytes ($ED00 table offset, $E900 table offset)</td>
</tr>
<tr>
<td class="address-1"><span id="52185"></span>CBD9</td>
<td class="instruction">LD DE,$0000</td>
<td class="comment-1" rowspan="1">Pair of NOPs for <a href="CBCE.html#52257">CC21</a> &amp; <a href="CBCE.html#52258">CC22</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52188"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="CBCE.html">CBCE</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="52188"></span>CBDC</td>
<td class="instruction">LD ($CC21),DE</td>
<td class="comment-1" rowspan="1">Write instructions in <span class="register">DE</span> to <a href="CBCE.html#52257">CC21</a> &amp; <a href="CBCE.html#52258">CC22</a></td>
</tr>
<tr>
<td class="address-1"><span id="52192"></span>CBE0</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="2">Self modify 'LD HL' @ <a href="CBCE.html#52336">CC70</a> to load ($ED00 + H)</td>
</tr>
<tr>
<td class="address-1"><span id="52193"></span>CBE1</td>
<td class="instruction">LD ($CC72),A</td>
</tr>
<tr>
<td class="address-1"><span id="52196"></span>CBE4</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="2">Self modify 'LD HL' @ <a href="CBCE.html#52389">CCA5</a> to load ($E900 + L)</td>
</tr>
<tr>
<td class="address-1"><span id="52197"></span>CBE5</td>
<td class="instruction">LD ($CCA7),A</td>
</tr>
<tr>
<td class="address-1"><span id="52200"></span>CBE8</td>
<td class="instruction">LD HL,($A240)</td>
<td class="comment-1" rowspan="1">Load road_buffer_offset into <span class="register">HL</span></td>
</tr>
<tr>
<td class="address-1"><span id="52203"></span>CBEB</td>
<td class="instruction">LD C,(HL)</td>
<td class="comment-1" rowspan="1">Read a curvature data byte</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52204"></span>
<div class="comments">
<div class="paragraph">
There's similar code at <a href="CD3A.html#52551">CD47</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="52204"></span>CBEC</td>
<td class="instruction">LD A,($A23F)</td>
<td class="comment-1" rowspan="2">A = fast_counter &amp; $E0  -- top three bits</td>
</tr>
<tr>
<td class="address-1"><span id="52207"></span>CBEF</td>
<td class="instruction">AND $E0</td>
</tr>
<tr>
<td class="address-1"><span id="52209"></span>CBF1</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52210"></span>
<div class="comments">
<div class="paragraph">
Reduces A by 31.25% ... unsure why that figure.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="52210"></span>CBF2</td>
<td class="instruction">RRC B</td>
<td class="comment-1" rowspan="3">Divide A by 4 and subtract</td>
</tr>
<tr>
<td class="address-1"><span id="52212"></span>CBF4</td>
<td class="instruction">RRC B</td>
</tr>
<tr>
<td class="address-1"><span id="52214"></span>CBF6</td>
<td class="instruction">SUB B</td>
</tr>
<tr>
<td class="address-1"><span id="52215"></span>CBF7</td>
<td class="instruction">RRC B</td>
<td class="comment-1" rowspan="3">Divide A by 16 and subtract</td>
</tr>
<tr>
<td class="address-1"><span id="52217"></span>CBF9</td>
<td class="instruction">RRC B</td>
</tr>
<tr>
<td class="address-1"><span id="52219"></span>CBFB</td>
<td class="instruction">SUB B</td>
</tr>
<tr>
<td class="address-1"><span id="52220"></span>CBFC</td>
<td class="instruction">ADD A,$B0</td>
<td class="comment-1" rowspan="5"><span class="register">IY</span> = data_e6b0[<span class="register">A</span>]</td>
</tr>
<tr>
<td class="address-1"><span id="52222"></span>CBFE</td>
<td class="instruction">LD IYl,A</td>
</tr>
<tr>
<td class="address-1"><span id="52224"></span>CC00</td>
<td class="instruction">LD A,$E6</td>
</tr>
<tr>
<td class="address-1"><span id="52226"></span>CC02</td>
<td class="instruction">ADC A,$00</td>
</tr>
<tr>
<td class="address-1"><span id="52228"></span>CC04</td>
<td class="instruction">LD IYh,A</td>
</tr>
<tr>
<td class="address-1"><span id="52230"></span>CC06</td>
<td class="instruction">CALL <a href="CDD6.html">multiply</a></td>
<td class="comment-1" rowspan="1">Call multiply (A = multiplier, C = multiplicand)</td>
</tr>
<tr>
<td class="address-1"><span id="52233"></span>CC09</td>
<td class="instruction">NEG</td>
<td class="comment-1" rowspan="3">A = (128 - A) &amp; $FE</td>
</tr>
<tr>
<td class="address-1"><span id="52235"></span>CC0B</td>
<td class="instruction">ADD A,$80</td>
</tr>
<tr>
<td class="address-1"><span id="52237"></span>CC0D</td>
<td class="instruction">AND $FE</td>
</tr>
<tr>
<td class="address-1"><span id="52239"></span>CC0F</td>
<td class="instruction">LD IXl,A</td>
<td class="comment-1" rowspan="2">IX = $E500 + A  -- distance shift table</td>
</tr>
<tr>
<td class="address-1"><span id="52241"></span>CC11</td>
<td class="instruction">LD IXh,$E5</td>
</tr>
<tr>
<td class="address-1"><span id="52244"></span>CC14</td>
<td class="instruction">LD DE,$E320</td>
<td class="comment-1" rowspan="1">not a pointer, separate values</td>
</tr>
<tr>
<td class="address-1"><span id="52247"></span>CC17</td>
<td class="instruction">LD B,$16</td>
<td class="comment-1" rowspan="1">20 iterations</td>
</tr>
<tr>
<td class="address-1"><span id="52249"></span>CC19</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Bank</td>
</tr>
<tr>
<td class="address-1"><span id="52250"></span>CC1A</td>
<td class="instruction">LD DE,($A26C)</td>
<td class="comment-1" rowspan="1">Get road position</td>
</tr>
<tr>
<td class="address-1"><span id="52254"></span>CC1E</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52255"></span>CC1F</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Unbank</td>
</tr>
<tr>
<td class="address-2"><span id="52256"></span>CC20</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1">Read road buffer byte</td>
</tr>
<tr>
<td class="address-1"><span id="52257"></span>CC21</td>
<td class="instruction">NOP</td>
<td class="comment-1" rowspan="2">Self modified above - Set to NOP or NEG</td>
</tr>
<tr>
<td class="address-1"><span id="52258"></span>CC22</td>
<td class="instruction">NOP</td>
</tr>
<tr>
<td class="address-1"><span id="52259"></span>CC23</td>
<td class="instruction">INC L</td>
<td class="comment-1" rowspan="1">Advance road buffer pointer (wrapping)</td>
</tr>
<tr>
<td class="address-1"><span id="52260"></span>CC24</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Bank</td>
</tr>
<tr>
<td class="address-1"><span id="52261"></span>CC25</td>
<td class="instruction">ADD A,IXl</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52263"></span>CC27</td>
<td class="instruction">LD IXl,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52265"></span>CC29</td>
<td class="instruction">LD HL,$0000</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52268"></span>CC2C</td>
<td class="instruction">LD A,(IX+$00)</td>
<td class="comment-1" rowspan="1">Reads from the <a href="E540.html">E540</a> table (distance shift table)</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52271"></span>
<div class="comments">
<div class="paragraph">
Subtract DE from table entry, result in BC.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="52271"></span>CC2F</td>
<td class="instruction">SUB E</td>
<td class="comment-1" rowspan="1">A -= E</td>
</tr>
<tr>
<td class="address-1"><span id="52272"></span>CC30</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1">C = A</td>
</tr>
<tr>
<td class="address-1"><span id="52273"></span>CC31</td>
<td class="instruction">LD A,(IX+$01)</td>
<td class="comment-1" rowspan="1">high byte</td>
</tr>
<tr>
<td class="address-1"><span id="52276"></span>CC34</td>
<td class="instruction">SBC A,D</td>
<td class="comment-1" rowspan="1">A -= D</td>
</tr>
<tr>
<td class="address-1"><span id="52277"></span>CC35</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1">B = A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52278"></span>
<div class="comments">
<div class="paragraph">
Sampled IY = E71E E71F E720 ..
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="52278"></span>CC36</td>
<td class="instruction">LD A,(IY+$00)</td>
<td class="comment-1" rowspan="1">IY seems to point to $E6xx..E7xx</td>
</tr>
<tr>
<td class="address-1"><span id="52281"></span>CC39</td>
<td class="instruction">INC IY</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52283"></span>
<div class="comments">
<div class="paragraph">
This is a multiplier of HL (distance shift value computed above) by A (value from $E600+).
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="52283"></span>CC3B</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">shift left</td>
</tr>
<tr>
<td class="address-1"><span id="52284"></span>CC3C</td>
<td class="instruction">JR NC,$CC41</td>
<td class="comment-1" rowspan="1">top bit not set</td>
</tr>
<tr>
<td class="address-1"><span id="52286"></span>CC3E</td>
<td class="instruction">LD H,B</td>
<td class="comment-1" rowspan="2">HL = BC  copy of distance shift value</td>
</tr>
<tr>
<td class="address-1"><span id="52287"></span>CC3F</td>
<td class="instruction">LD L,C</td>
</tr>
<tr>
<td class="address-1"><span id="52288"></span>CC40</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="1">shift result left. HL seems to be zeroed above, so this is confusing</td>
</tr>
<tr>
<td class="address-2"><span id="52289"></span>CC41</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">shift topmost bit out</td>
</tr>
<tr>
<td class="address-1"><span id="52290"></span>CC42</td>
<td class="instruction">JR NC,$CC45</td>
<td class="comment-1" rowspan="1">jump if top bit not set</td>
</tr>
<tr>
<td class="address-1"><span id="52292"></span>CC44</td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-1" rowspan="1">otherwise HL += BC</td>
</tr>
<tr>
<td class="address-2"><span id="52293"></span>CC45</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="4">repeat</td>
</tr>
<tr>
<td class="address-1"><span id="52294"></span>CC46</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="address-1"><span id="52295"></span>CC47</td>
<td class="instruction">JR NC,$CC4A</td>
</tr>
<tr>
<td class="address-1"><span id="52297"></span>CC49</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="address-2"><span id="52298"></span>CC4A</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="4">repeat</td>
</tr>
<tr>
<td class="address-1"><span id="52299"></span>CC4B</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="address-1"><span id="52300"></span>CC4C</td>
<td class="instruction">JR NC,$CC4F</td>
</tr>
<tr>
<td class="address-1"><span id="52302"></span>CC4E</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="address-2"><span id="52303"></span>CC4F</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="4">repeat</td>
</tr>
<tr>
<td class="address-1"><span id="52304"></span>CC50</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="address-1"><span id="52305"></span>CC51</td>
<td class="instruction">JR NC,$CC54</td>
</tr>
<tr>
<td class="address-1"><span id="52307"></span>CC53</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="address-2"><span id="52308"></span>CC54</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="4">repeat</td>
</tr>
<tr>
<td class="address-1"><span id="52309"></span>CC55</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="address-1"><span id="52310"></span>CC56</td>
<td class="instruction">JR NC,$CC59</td>
</tr>
<tr>
<td class="address-1"><span id="52312"></span>CC58</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="address-2"><span id="52313"></span>CC59</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="1">A = H</td>
</tr>
<tr>
<td class="address-1"><span id="52314"></span>CC5A</td>
<td class="instruction">RL L</td>
<td class="comment-1" rowspan="1">L &lt;&lt;= 1</td>
</tr>
<tr>
<td class="address-1"><span id="52316"></span>CC5C</td>
<td class="instruction">LD H,$00</td>
<td class="comment-1" rowspan="1">H = 0</td>
</tr>
<tr>
<td class="address-1"><span id="52318"></span>CC5E</td>
<td class="instruction">ADC A,H</td>
<td class="comment-1" rowspan="1">A += H + carry</td>
</tr>
<tr>
<td class="address-1"><span id="52319"></span>CC5F</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1">L = A</td>
</tr>
<tr>
<td class="address-1"><span id="52320"></span>CC60</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">A &lt;&lt;= 1</td>
</tr>
<tr>
<td class="address-1"><span id="52321"></span>CC61</td>
<td class="instruction">JR NC,$CC64</td>
<td class="comment-1" rowspan="1">jump if top bit not set</td>
</tr>
<tr>
<td class="address-1"><span id="52323"></span>CC63</td>
<td class="instruction">DEC H</td>
<td class="comment-1" rowspan="1">H--</td>
</tr>
<tr>
<td class="address-2"><span id="52324"></span>CC64</td>
<td class="instruction">RRA</td>
<td class="comment-1" rowspan="1">A &gt;&gt;= 1</td>
</tr>
<tr>
<td class="address-1"><span id="52325"></span>CC65</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52326"></span>CC66</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52327"></span>CC67</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Unbank</td>
</tr>
<tr>
<td class="address-1"><span id="52328"></span>CC68</td>
<td class="instruction">LD (DE),A</td>
<td class="comment-1" rowspan="2">*DE++ = A</td>
</tr>
<tr>
<td class="address-1"><span id="52329"></span>CC69</td>
<td class="instruction">INC E</td>
</tr>
<tr>
<td class="address-1"><span id="52330"></span>CC6A</td>
<td class="instruction">DJNZ $CC20</td>
<td class="comment-1" rowspan="1">Loop back to read buffer byte bit</td>
</tr>
<tr>
<td class="address-1"><span id="52332"></span>CC6C</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52333"></span>CC6D</td>
<td class="instruction">LD B,$00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52335"></span>CC6F</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Bank</td>
</tr>
<tr>
<td class="address-1"><span id="52336"></span>CC70</td>
<td class="instruction">LD HL,$ED00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52339"></span>CC73</td>
<td class="instruction">CALL $CCA8</td>
<td class="comment-1" rowspan="1">subroutine</td>
</tr>
<tr>
<td class="address-1"><span id="52342"></span>CC76</td>
<td class="instruction">LD A,($A23F)</td>
<td class="comment-1" rowspan="1">A = fast_counter</td>
</tr>
<tr>
<td class="address-1"><span id="52345"></span>CC79</td>
<td class="instruction">AND $E0</td>
<td class="comment-1" rowspan="1">take top three bits</td>
</tr>
<tr>
<td class="address-1"><span id="52347"></span>CC7B</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="7">same pattern as above</td>
</tr>
<tr>
<td class="address-1"><span id="52348"></span>CC7C</td>
<td class="instruction">RRC B</td>
</tr>
<tr>
<td class="address-1"><span id="52350"></span>CC7E</td>
<td class="instruction">RRC B</td>
</tr>
<tr>
<td class="address-1"><span id="52352"></span>CC80</td>
<td class="instruction">SUB B</td>
</tr>
<tr>
<td class="address-1"><span id="52353"></span>CC81</td>
<td class="instruction">RRC B</td>
</tr>
<tr>
<td class="address-1"><span id="52355"></span>CC83</td>
<td class="instruction">RRC B</td>
</tr>
<tr>
<td class="address-1"><span id="52357"></span>CC85</td>
<td class="instruction">SUB B</td>
</tr>
<tr>
<td class="address-1"><span id="52358"></span>CC86</td>
<td class="instruction">ADD A,$60</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52360"></span>CC88</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="2">HL = $E700 | A</td>
</tr>
<tr>
<td class="address-1"><span id="52361"></span>CC89</td>
<td class="instruction">LD H,$E7</td>
</tr>
<tr>
<td class="address-1"><span id="52363"></span>CC8B</td>
<td class="instruction">JR NC,$CC8E</td>
<td class="comment-1" rowspan="1">Jump if A+$60 had no carry</td>
</tr>
<tr>
<td class="address-1"><span id="52365"></span>CC8D</td>
<td class="instruction">INC H</td>
<td class="comment-1" rowspan="1">Add carry otherwise</td>
</tr>
<tr>
<td class="address-2"><span id="52366"></span>CC8E</td>
<td class="instruction">LD DE,$E320</td>
<td class="comment-1" rowspan="1">[points to presumed lanes data in pristine memory map but must be something else]</td>
</tr>
<tr>
<td class="address-1"><span id="52369"></span>CC91</td>
<td class="instruction">LD B,$16</td>
<td class="comment-1" rowspan="1">B = 20</td>
</tr>
<tr>
<td class="address-2"><span id="52371"></span>CC93</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-1" rowspan="1">*DE += *HL</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="52372"></span>
<div class="comments">
<div class="paragraph">
This reads from $E760+ in sequence.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="52372"></span>CC94</td>
<td class="instruction">ADD A,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52373"></span>CC95</td>
<td class="instruction">LD (DE),A</td>
<td class="comment-1" rowspan="1">}</td>
</tr>
<tr>
<td class="address-1"><span id="52374"></span>CC96</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">HL++</td>
</tr>
<tr>
<td class="address-1"><span id="52375"></span>CC97</td>
<td class="instruction">INC E</td>
<td class="comment-1" rowspan="1">E++</td>
</tr>
<tr>
<td class="address-1"><span id="52376"></span>CC98</td>
<td class="instruction">DJNZ $CC93</td>
<td class="comment-1" rowspan="1">Loop while B</td>
</tr>
<tr>
<td class="address-1"><span id="52378"></span>CC9A</td>
<td class="instruction">LD HL,($A26C)</td>
<td class="comment-1" rowspan="3">HL = road position - 295</td>
</tr>
<tr>
<td class="address-1"><span id="52381"></span>CC9D</td>
<td class="instruction">LD DE,$FED9</td>
</tr>
<tr>
<td class="address-1"><span id="52384"></span>CCA0</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="address-1"><span id="52385"></span>CCA1</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">swap</td>
</tr>
<tr>
<td class="address-1"><span id="52386"></span>CCA2</td>
<td class="instruction">LD B,$00</td>
<td class="comment-1" rowspan="1">B = 0</td>
</tr>
<tr>
<td class="address-1"><span id="52388"></span>CCA4</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Unbank</td>
</tr>
<tr>
<td class="address-1"><span id="52389"></span>CCA5</td>
<td class="instruction">LD HL,$E900</td>
<td class="comment-1" rowspan="1">table?</td>
</tr>
<tr>
<td class="address-2"><span id="52392"></span>CCA8</td>
<td class="instruction">LD IY,$E300</td>
<td class="comment-1" rowspan="1">table?</td>
</tr>
<tr>
<td class="address-1"><span id="52396"></span>CCAC</td>
<td class="instruction">LD B,$15</td>
<td class="comment-1" rowspan="1">B = 21</td>
</tr>
<tr>
<td class="address-1"><span id="52398"></span>CCAE</td>
<td class="instruction">LD ($CCF5),SP</td>
<td class="comment-1" rowspan="1">Save <span class="register">SP</span> to restore later (self modify)</td>
</tr>
<tr>
<td class="address-1"><span id="52402"></span>CCB2</td>
<td class="instruction">LD SP,HL</td>
<td class="comment-1" rowspan="1">Put address in <span class="register">SP</span> (so we can use POP for speed)</td>
</tr>
<tr>
<td class="address-2"><span id="52403"></span>CCB3</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Bank</td>
</tr>
<tr>
<td class="address-1"><span id="52404"></span>CCB4</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="2">A = B - 2</td>
</tr>
<tr>
<td class="address-1"><span id="52405"></span>CCB5</td>
<td class="instruction">SUB $02</td>
</tr>
<tr>
<td class="address-1"><span id="52407"></span>CCB7</td>
<td class="instruction">ADD A,(IY+$00)</td>
<td class="comment-1" rowspan="1">A += *IY</td>
</tr>
<tr>
<td class="address-1"><span id="52410"></span>CCBA</td>
<td class="instruction">INC IYl</td>
<td class="comment-1" rowspan="1">IY++</td>
</tr>
<tr>
<td class="address-1"><span id="52412"></span>CCBC</td>
<td class="instruction">SUB (IY+$00)</td>
<td class="comment-1" rowspan="1">A -= *IY</td>
</tr>
<tr>
<td class="address-1"><span id="52415"></span>CCBF</td>
<td class="instruction">JP M,$CD0C</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52418"></span>CCC2</td>
<td class="instruction">ADD A,$02</td>
<td class="comment-1" rowspan="1">A += 2</td>
</tr>
<tr>
<td class="address-1"><span id="52420"></span>CCC4</td>
<td class="instruction">LD (IY+$4E),A</td>
<td class="comment-1" rowspan="1">IY[$4E] = A</td>
</tr>
<tr>
<td class="address-1"><span id="52423"></span>CCC7</td>
<td class="instruction">SUB B</td>
<td class="comment-1" rowspan="1">A -= B</td>
</tr>
<tr>
<td class="address-1"><span id="52424"></span>CCC8</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1">C = A</td>
</tr>
<tr>
<td class="address-1"><span id="52425"></span>CCC9</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1">B = A</td>
</tr>
<tr>
<td class="address-1"><span id="52426"></span>CCCA</td>
<td class="instruction">LD L,(IY+$1F)</td>
<td class="comment-1" rowspan="1">L = IY[$1F]</td>
</tr>
<tr>
<td class="address-1"><span id="52429"></span>CCCD</td>
<td class="instruction">BIT 7,L</td>
<td class="comment-1" rowspan="1">test bit 7 of L</td>
</tr>
<tr>
<td class="address-1"><span id="52431"></span>CCCF</td>
<td class="instruction">JR Z,$CCDE</td>
<td class="comment-1" rowspan="1">jump if ?</td>
</tr>
<tr>
<td class="address-1"><span id="52433"></span>CCD1</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="3">L = -L</td>
</tr>
<tr>
<td class="address-1"><span id="52434"></span>CCD2</td>
<td class="instruction">NEG</td>
</tr>
<tr>
<td class="address-1"><span id="52436"></span>CCD4</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="address-1"><span id="52437"></span>CCD5</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="1">A = B</td>
</tr>
<tr>
<td class="address-1"><span id="52438"></span>CCD6</td>
<td class="instruction">CP L</td>
<td class="comment-1" rowspan="1">A &lt; L ?</td>
</tr>
<tr>
<td class="address-1"><span id="52439"></span>CCD7</td>
<td class="instruction">LD A,$1B</td>
<td class="comment-1" rowspan="1">Opcode for DEC DE</td>
</tr>
<tr>
<td class="address-1"><span id="52441"></span>CCD9</td>
<td class="instruction">JR C,$CCF8</td>
<td class="comment-1" rowspan="1">jump if A &lt; L</td>
</tr>
<tr>
<td class="address-1"><span id="52443"></span>CCDB</td>
<td class="instruction">JP $CCE3</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="52446"></span>CCDE</td>
<td class="instruction">CP L</td>
<td class="comment-1" rowspan="1">A &lt; L ?</td>
</tr>
<tr>
<td class="address-1"><span id="52447"></span>CCDF</td>
<td class="instruction">LD A,$13</td>
<td class="comment-1" rowspan="1">Opcode for INC DE</td>
</tr>
<tr>
<td class="address-1"><span id="52449"></span>CCE1</td>
<td class="instruction">JR C,$CCF8</td>
<td class="comment-1" rowspan="1">jump if A &lt; L</td>
</tr>
<tr>
<td class="address-2"><span id="52451"></span>CCE3</td>
<td class="instruction">LD ($CCED),A</td>
<td class="comment-1" rowspan="1">Self modify instruction below</td>
</tr>
<tr>
<td class="address-1"><span id="52454"></span>CCE6</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="1">A = B</td>
</tr>
<tr>
<td class="address-1"><span id="52455"></span>CCE7</td>
<td class="instruction">RRA</td>
<td class="comment-1" rowspan="1">A &gt;&gt;= 1</td>
</tr>
<tr>
<td class="address-2"><span id="52456"></span>CCE8</td>
<td class="instruction">ADD A,L</td>
<td class="comment-1" rowspan="1">A += L</td>
</tr>
<tr>
<td class="address-1"><span id="52457"></span>CCE9</td>
<td class="instruction">CP C</td>
<td class="comment-1" rowspan="1">A &lt; C ?</td>
</tr>
<tr>
<td class="address-1"><span id="52458"></span>CCEA</td>
<td class="instruction">JR C,$CCEE</td>
<td class="comment-1" rowspan="1">jump if A &lt; C</td>
</tr>
<tr>
<td class="address-1"><span id="52460"></span>CCEC</td>
<td class="instruction">SUB C</td>
<td class="comment-1" rowspan="1">A -= C</td>
</tr>
<tr>
<td class="address-1"><span id="52461"></span>CCED</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1">Self modified: INC DE or DEC DE</td>
</tr>
<tr>
<td class="address-2"><span id="52462"></span>CCEE</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52463"></span>CCEF</td>
<td class="instruction">DJNZ $CCE8</td>
<td class="comment-1" rowspan="1">Loop while B</td>
</tr>
<tr>
<td class="address-1"><span id="52465"></span>CCF1</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Unbank</td>
</tr>
<tr>
<td class="address-1"><span id="52466"></span>CCF2</td>
<td class="instruction">DJNZ $CCB3</td>
<td class="comment-1" rowspan="1">Outer loop?</td>
</tr>
<tr>
<td class="address-2"><span id="52468"></span>CCF4</td>
<td class="instruction">LD SP,$0000</td>
<td class="comment-1" rowspan="1">Restore original SP (must be self modified)</td>
</tr>
<tr>
<td class="address-1"><span id="52471"></span>CCF7</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return</td>
</tr>
<tr>
<td class="address-2"><span id="52472"></span>CCF8</td>
<td class="instruction">LD ($CCFC),A</td>
<td class="comment-1" rowspan="1">Self modify instruction below</td>
</tr>
<tr>
<td class="address-1"><span id="52475"></span>CCFB</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1">A = 0</td>
</tr>
<tr>
<td class="address-2"><span id="52476"></span>CCFC</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1">Self modified: INC DE or DEC DE</td>
</tr>
<tr>
<td class="address-1"><span id="52477"></span>CCFD</td>
<td class="instruction">ADD A,C</td>
<td class="comment-1" rowspan="1">A += C</td>
</tr>
<tr>
<td class="address-1"><span id="52478"></span>CCFE</td>
<td class="instruction">JR C,$CD03</td>
<td class="comment-1" rowspan="1">jump if overflow</td>
</tr>
<tr>
<td class="address-1"><span id="52480"></span>CD00</td>
<td class="instruction">CP L</td>
<td class="comment-1" rowspan="1">A &lt; L ?</td>
</tr>
<tr>
<td class="address-1"><span id="52481"></span>CD01</td>
<td class="instruction">JR C,$CCFC</td>
<td class="comment-1" rowspan="1">jump if A &lt; L</td>
</tr>
<tr>
<td class="address-2"><span id="52483"></span>CD03</td>
<td class="instruction">SUB L</td>
<td class="comment-1" rowspan="1">A -= L</td>
</tr>
<tr>
<td class="address-1"><span id="52484"></span>CD04</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52485"></span>CD05</td>
<td class="instruction">DJNZ $CCFC</td>
<td class="comment-1" rowspan="1">Loop while B</td>
</tr>
<tr>
<td class="address-1"><span id="52487"></span>CD07</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Bank</td>
</tr>
<tr>
<td class="address-1"><span id="52488"></span>CD08</td>
<td class="instruction">DJNZ $CCB3</td>
<td class="comment-1" rowspan="1">Outer loop?</td>
</tr>
<tr>
<td class="address-1"><span id="52490"></span>CD0A</td>
<td class="instruction">JR $CCF4</td>
<td class="comment-1" rowspan="1">Exit</td>
</tr>
<tr>
<td class="address-2"><span id="52492"></span>CD0C</td>
<td class="instruction">LD (IY+$4E),$01</td>
<td class="comment-1" rowspan="1">IY[$4E] = 1</td>
</tr>
<tr>
<td class="address-1"><span id="52496"></span>CD10</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1">A++</td>
</tr>
<tr>
<td class="address-1"><span id="52497"></span>CD11</td>
<td class="instruction">JR Z,$CD27</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="52499"></span>CD13</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1">A++</td>
</tr>
<tr>
<td class="address-1"><span id="52500"></span>CD14</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1">B = A</td>
</tr>
<tr>
<td class="address-1"><span id="52501"></span>CD15</td>
<td class="instruction">LD A,(IY+$1F)</td>
<td class="comment-1" rowspan="1">A = IY[$1F]</td>
</tr>
<tr>
<td class="address-1"><span id="52504"></span>CD18</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1">L = A</td>
</tr>
<tr>
<td class="address-1"><span id="52505"></span>CD19</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">A &lt;&lt;= 1</td>
</tr>
<tr>
<td class="address-1"><span id="52506"></span>CD1A</td>
<td class="instruction">SBC A,A</td>
<td class="comment-1" rowspan="1">A = A - A - carry</td>
</tr>
<tr>
<td class="address-1"><span id="52507"></span>CD1B</td>
<td class="instruction">LD H,A</td>
<td class="comment-1" rowspan="1">H = A</td>
</tr>
<tr>
<td class="address-1"><span id="52508"></span>CD1C</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1">HL += DE</td>
</tr>
<tr>
<td class="address-1"><span id="52509"></span>CD1D</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">swap</td>
</tr>
<tr>
<td class="address-1"><span id="52510"></span>CD1E</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1">push</td>
</tr>
<tr>
<td class="address-1"><span id="52511"></span>CD1F</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Unbank</td>
</tr>
<tr>
<td class="address-1"><span id="52512"></span>CD20</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1">B--</td>
</tr>
<tr>
<td class="address-1"><span id="52513"></span>CD21</td>
<td class="instruction">JP NZ,$CCB3</td>
<td class="comment-1" rowspan="1">Outer loop?</td>
</tr>
<tr>
<td class="address-1"><span id="52516"></span>CD24</td>
<td class="instruction">JP $CCF4</td>
<td class="comment-1" rowspan="1">Exit</td>
</tr>
<tr>
<td class="address-2"><span id="52519"></span>CD27</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1">B = A</td>
</tr>
<tr>
<td class="address-1"><span id="52520"></span>CD28</td>
<td class="instruction">LD A,(IY+$1F)</td>
<td class="comment-1" rowspan="1">A = IY[$1F]</td>
</tr>
<tr>
<td class="address-1"><span id="52523"></span>CD2B</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1">L = A</td>
</tr>
<tr>
<td class="address-1"><span id="52524"></span>CD2C</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">A &lt;&lt;= 1</td>
</tr>
<tr>
<td class="address-1"><span id="52525"></span>CD2D</td>
<td class="instruction">SBC A,A</td>
<td class="comment-1" rowspan="1">A = A - A - carry</td>
</tr>
<tr>
<td class="address-1"><span id="52526"></span>CD2E</td>
<td class="instruction">LD H,A</td>
<td class="comment-1" rowspan="1">H = A</td>
</tr>
<tr>
<td class="address-1"><span id="52527"></span>CD2F</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1">HL += DE</td>
</tr>
<tr>
<td class="address-1"><span id="52528"></span>CD30</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">swap</td>
</tr>
<tr>
<td class="address-1"><span id="52529"></span>CD31</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1">push</td>
</tr>
<tr>
<td class="address-1"><span id="52530"></span>CD32</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Bank</td>
</tr>
<tr>
<td class="address-1"><span id="52531"></span>CD33</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1">B--</td>
</tr>
<tr>
<td class="address-1"><span id="52532"></span>CD34</td>
<td class="instruction">JP NZ,$CCB3</td>
<td class="comment-1" rowspan="1">Outer loop?</td>
</tr>
<tr>
<td class="address-1"><span id="52535"></span>CD37</td>
<td class="instruction">JP $CCF4</td>
<td class="comment-1" rowspan="1">Exit</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="CBC5.html">CBC5</a>
</td>
<td class="up">Up: <a href="../maps/all.html#52174">Map</a></td>
<td class="next">
Next: <a href="CD3A.html">CD3A</a>
</td>
</tr>
</table>
<footer>
<div class="release">The incomplete Chase H.Q. disassembly 20231102</div>
<div class="copyright">&copy; 1988 Taito Corporation &copy; 1989 Ocean Software Ltd. (Chase H.Q.) Â© 2023 David Thomas (this disassembly)</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.9.</div>
</footer>
</body>
</html>